import{O as T}from"./OrganizationLayout-e59c3130.js";import{C as B,_ as b,a as F}from"./ImageUploadAdapter-1b833612.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{b as n,M as C,ab as k,a6 as z,i,o as u,c as g,w as l,a as p,t as s,f as d,d as y,F as w,e as q,h as V,k as Y}from"./app-78468d3b.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const Q={components:{OrganizationLayout:T,ckeditor:B.component,UploadAdapter:b,createVNode:n,Modal:C,ExclamationCircleOutlined:k,DeleteOutlined:z},props:["exam"],data(){return{dateFormat:"YYYY-MM-DD",randomList:[],modal:{isOpen:!1,data:{},title:"Modal",mode:""},virticalStyle:{display:"block",height:"30px",lineHeight:"30px",width:"100%"},teacherStateLabels:{},editor:F,editorData:"<p>Content of the editor.</p>",editorConfig:{extraPlugins:[function(e){e.plugins.get("FileRepository").createUploadAdapter=t=>new b(t)}]},columns:[{title:"Title",i18n:"question_title",dataIndex:"title"},{title:"Options",i18n:"question_options",dataIndex:"options",key:"options"},{title:"Answer",i18n:"question_answer",dataIndex:"answer",key:"answer"},{title:"Score",i18n:"question_score",dataIndex:"score",key:"score"},{title:"Operation",i18n:"operation",dataIndex:"operation",key:"operation"}],rules:{title:{required:!0},options:{required:!0},answer:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},mounted(){},methods:{generateRandomList(e){this.randomList=[];for(var t=0;t<10;t++){var r=Math.floor(Math.random()*900)+100;this.randomList.push(r)}e.options.map((x,a)=>{x.value=this.randomList[a]}),e.answer=null},createRecord(){this.modal.data={},this.modal.data.published=0,this.modal.mode="CREATE",this.modal.title="Create",this.modal.isOpen=!0},editRecord(e){console.log(e),this.modal.data=_.cloneDeep(e),this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("manage.exams.store"),this.modal.data,{onSuccess:e=>{this.modal.data={},this.modal.isOpen=!1},onError:e=>{console.log(e)}})}).catch(e=>{console.log(e)})},updateRecord(){console.log(this.modal.data),this.$refs.modalRef.validateFields().then(()=>{this.$inertia.put(route("manage.exam.questions.update",{exam:this.modal.data.exam_id,question:this.modal.data.id}),this.modal.data,{onSuccess:e=>{this.modal.data={},this.modal.isOpen=!1,console.log(e)},onError:e=>{console.log(e)}})}).catch(e=>{console.log("error",e)})},deleteConfirmed(e){this.$inertia.delete(route("manage.exams.destroy",e.id),{onSuccess:t=>{console.log(t)},onError:t=>{console.log(t)}})},deleteRecord(e){confirm("Are you sure want to remove?")&&this.$inertia.delete(route("manage.exams.destroy",e),{onSuccess:t=>{console.log(t)},onError:t=>{console.log(t)}})},uploader(e){e.plugins.get("FileRepository").createUploadAdapter=t=>new b(t)},onBlurNewOption(e){this.randomList.length==0&&this.generateRandomList(this.modal.data),e&&(this.modal.data.options.push({value:this.randomList[this.modal.data.options.length],label:e}),console.log(this.modal.data.options),console.log(this.exam.questions),this.modal.data.newOption=null)},removeOptionItem(e){C.confirm({title:"是否確定",icon:n(k),content:"刪除報名記錄?"+e.label,okText:"確定",cancelText:"取消",onOk:()=>{this.modal.data.options=this.modal.data.options.reduce((t,r)=>(r.value!==e.value&&t.push(r),t),[])}})}}},H={class:"font-semibold text-xl text-gray-800 leading-tight"},K={class:"flex-auto pb-3 text-right"},P={class:"container mx-auto pt-5"},$={class:"bg-white relative shadow rounded-lg overflow-x-auto"},j=["onClick"];function G(e,t,r,x,a,m){const c=i("a-button"),O=i("a-table"),h=i("a-input"),f=i("a-form-item"),R=i("delete-outlined"),E=i("a-radio"),S=i("a-radio-group"),L=i("a-input-search"),I=i("a-form"),U=i("a-modal"),D=i("OrganizationLayout");return u(),g(D,{title:"Dashboard"},{header:l(()=>[p("h2",H,s(e.$t("question")),1)]),default:l(()=>[p("p",null,"Exam title: "+s(r.exam.title),1),p("p",null,"Exam category: "+s(r.exam.category_code),1),p("div",K,[n(c,{onClick:t[0]||(t[0]=o=>m.createRecord())},{default:l(()=>[d("Create")]),_:1})]),p("div",P,[p("div",$,[n(O,{dataSource:r.exam.questions,columns:a.columns},{headerCell:l(({column:o})=>[d(s(o.i18n?e.$t(o.i18n):o.title),1)]),bodyCell:l(({column:o,text:M,record:v,index:J})=>[o.dataIndex=="operation"?(u(),y(w,{key:0},[n(c,{onClick:A=>m.editRecord(v)},{default:l(()=>[d("Edit")]),_:2},1032,["onClick"]),n(c,{disabled:v.published,onClick:A=>m.deleteRecord(v)},{default:l(()=>[d(s(e.$t("delete")),1)]),_:2},1032,["disabled","onClick"])],64)):(u(),y(w,{key:1},[d(s(v[o.dataIndex]),1)],64))]),_:1},8,["dataSource","columns"])])]),n(U,{visible:a.modal.isOpen,"onUpdate:visible":t[9]||(t[9]=o=>a.modal.isOpen=o),title:a.modal.title},{footer:l(()=>[a.modal.mode=="EDIT"?(u(),g(c,{key:"Update",type:"primary",onClick:t[7]||(t[7]=o=>m.updateRecord())},{default:l(()=>[d(s(e.$t("update")),1)]),_:1})):q("",!0),a.modal.mode=="CREATE"?(u(),g(c,{key:"Store",type:"primary",onClick:t[8]||(t[8]=o=>m.storeRecord())},{default:l(()=>[d(s(e.$t("add")),1)]),_:1})):q("",!0)]),default:l(()=>[n(I,{ref:"modalRef",model:a.modal.data,name:"Questions",layout:"vertical",autocomplete:"off",rules:a.rules,"validate-messages":a.validateMessages},{default:l(()=>[n(f,{label:e.$t("question_title"),name:"title"},{default:l(()=>[n(h,{value:a.modal.data.title,"onUpdate:value":t[1]||(t[1]=o=>a.modal.data.title=o)},null,8,["value"])]),_:1},8,["label"]),n(f,{label:e.$t("question_type"),name:"question_type"},{default:l(()=>[n(h,{value:a.modal.data.type,"onUpdate:value":t[2]||(t[2]=o=>a.modal.data.type=o)},null,8,["value"])]),_:1},8,["label"]),n(f,{label:e.$t("question_options"),name:"answer"},{default:l(()=>[n(S,{value:a.modal.data.answer,"onUpdate:value":t[3]||(t[3]=o=>a.modal.data.answer=o),style:{width:"100%"}},{default:l(()=>[(u(!0),y(w,null,V(a.modal.data.options,o=>(u(),g(E,{style:Y(a.virticalStyle),value:o.value},{default:l(()=>[d(s(o.label)+" ",1),p("span",{class:"float-right",type:"delete",onClick:M=>m.removeOptionItem(o)},[n(R,{style:{color:"#eb2f96"}})],8,j)]),_:2},1032,["style","value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),n(f,{label:e.$t("question_new_option"),name:"question_new_option"},{default:l(()=>[n(L,{value:a.modal.data.newOption,"onUpdate:value":t[4]||(t[4]=o=>a.modal.data.newOption=o),onSearch:m.onBlurNewOption},{enterButton:l(()=>[n(c,null,{default:l(()=>[d("Add")]),_:1})]),_:1},8,["value","onSearch"])]),_:1},8,["label"]),n(f,{label:e.$t("question_answer"),name:"question_answer"},{default:l(()=>[n(h,{value:a.modal.data.answer,"onUpdate:value":t[5]||(t[5]=o=>a.modal.data.answer=o)},null,8,["value"])]),_:1},8,["label"]),n(f,{label:e.$t("question_score"),name:"question_score"},{default:l(()=>[n(h,{value:a.modal.data.score,"onUpdate:value":t[6]||(t[6]=o=>a.modal.data.score=o)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])]),_:1})}const ne=N(Q,[["render",G]]);export{ne as default};
