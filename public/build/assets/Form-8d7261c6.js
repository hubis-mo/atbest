import{O as F}from"./OrganizationLayout-e59c3130.js";import{q as R}from"./index-d20420be.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import{U as L}from"./UploadOutlined-e5283a52.js";import{a3 as O,a2 as M,J as b,i as m,o as r,c as d,w as n,a as i,b as a,t as u,e as c,d as h,f as T}from"./app-78468d3b.js";import{R as E}from"./RestFilled-9a3a2187.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const H={components:{OrganizationLayout:F,UploadOutlined:L,LoadingOutlined:O,PlusOutlined:M,RestFilled:E,quillEditor:R,message:b},props:["organization","form"],data(){return{breadcrumb:[{label:"表格列表",url:route("manage.forms.index")},{label:this.form.id?"表格修改":"表格新增",url:null}],loading:!1,imageUrl:null,rules:{name:{required:!0},title:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},mounted(){console.log(this.form)},methods:{onFinish(){console.log("on Finshed"),this.form.id?(console.log("Update"),this.updateRecord()):(console.log("Create"),this.storeRecord())},storeRecord(){this.$inertia.post(route("manage.forms.store"),this.form,{onSuccess:t=>{this.imageUrl=null},onError:t=>{console.log(t)}})},updateRecord(){this.form._method="PATCH",this.$inertia.post(route("manage.forms.update",this.form.id),this.form,{onSuccess:t=>{console.log(t)},onError:t=>{console.log(t)}})},uploadChange(t){console.log(t);const l=t.file.type==="image/jpeg"||t.file.type==="image/png";l||(console.log("image format!"),b.error("You can only upload JPG/PNG file!"));const e=t.file.size/1024/1024<.2;e||(console.log("image size"),b.error("Image must smaller than 2MB!")),l&&e?this.getBase64(t.file,v=>{this.imageUrl=v,this.loading=!0}):this.form.image=[]},getBase64(t,l){const e=new FileReader;e.addEventListener("load",()=>l(e.result)),e.readAsDataURL(t)}}},N={class:"container mx-auto"},P={class:"bg-white relative shadow p-5 rounded-lg overflow-x-auto"},S={class:"text-right"},J={class:"text-right"},W={class:"pl-3"},A={class:"pl-3"},D={class:"pl-3"},G=i("br",null,null,-1),j={key:0},x={class:"pl-3"},I={key:0},Y=i("svg",{focusable:"false",class:"","data-icon":"delete",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",viewBox:"64 64 896 896"},[i("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"})],-1),K=["src"],Q={key:1},X=["src"],Z={key:1},$={class:"ant-upload-text"};function ee(t,l,e,v,f,k){const p=m("a-input"),s=m("a-form-item"),g=m("quill-editor"),_=m("a-switch"),y=m("inertia-link"),w=m("loading-outlined"),U=m("plus-outlined"),C=m("a-upload"),q=m("a-button"),V=m("a-form"),z=m("OrganizationLayout");return r(),d(z,{title:e.form.id?"表格修改":"表格新增",breadcrumb:f.breadcrumb},{default:n(()=>[i("div",N,[i("div",P,[a(V,{ref:"modalRef",model:e.form,name:"From","label-col":{span:6},"wrapper-col":{span:18},autocomplete:"off",rules:f.rules,"validate-messages":f.validateMessages,onFinish:k.onFinish},{default:n(()=>[a(s,{label:t.$t("form_name"),name:"name"},{default:n(()=>[a(p,{value:e.form.name,"onUpdate:value":l[0]||(l[0]=o=>e.form.name=o)},null,8,["value"])]),_:1},8,["label"]),a(s,{label:t.$t("title"),name:"title"},{default:n(()=>[a(p,{value:e.form.title,"onUpdate:value":l[1]||(l[1]=o=>e.form.title=o)},null,8,["value"])]),_:1},8,["label"]),i("div",S,[i("a",{onClick:l[2]||(l[2]=o=>e.form.openWelcome=!e.form.openWelcome)},u(t.$t("form_welcome")),1)]),e.form.openWelcome?(r(),d(s,{key:0,label:t.$t("form_welcome"),name:"welcome"},{default:n(()=>[a(g,{value:e.form.welcome,"onUpdate:value":l[3]||(l[3]=o=>e.form.welcome=o),style:{"min-height":"200px"}},null,8,["value"])]),_:1},8,["label"])):c("",!0),a(s,{label:t.$t("description"),name:"description"},{default:n(()=>[a(g,{value:e.form.description,"onUpdate:value":l[4]||(l[4]=o=>e.form.description=o),style:{"min-height":"200px"}},null,8,["value"])]),_:1},8,["label"]),i("div",J,[i("a",{onClick:l[5]||(l[5]=o=>e.form.openThankyou=!e.form.openThankyou)},u(t.$t("form_thankyou")),1)]),e.form.openThankyou?(r(),d(s,{key:1,label:t.$t("form_thankyou"),name:"thankyou"},{default:n(()=>[a(g,{value:e.form.thankyou,"onUpdate:value":l[6]||(l[6]=o=>e.form.thankyou=o),style:{"min-height":"200px"}},null,8,["value"])]),_:1},8,["label"])):c("",!0),a(s,{label:t.$t("require_login"),name:"require_login"},{default:n(()=>[a(_,{checked:e.form.require_login,"onUpdate:checked":l[7]||(l[7]=o=>e.form.require_login=o),unCheckedValue:0,checkedValue:1,onChange:l[8]||(l[8]=o=>e.form.for_member=!1)},null,8,["checked"]),i("span",W,u(t.$t("require_login_note")),1)]),_:1},8,["label"]),e.form.require_login?(r(),d(s,{key:2,label:t.$t("for_member"),name:"for_member"},{default:n(()=>[a(_,{checked:e.form.for_member,"onUpdate:checked":l[9]||(l[9]=o=>e.form.for_member=o),unCheckedValue:0,checkedValue:1},null,8,["checked"]),i("span",A,u(t.$t("for_member_note")),1)]),_:1},8,["label"])):c("",!0),a(s,{label:t.$t("published"),name:"published"},{default:n(()=>[a(_,{checked:e.form.published,"onUpdate:checked":l[10]||(l[10]=o=>e.form.published=o),unCheckedValue:0,checkedValue:1,onChange:l[11]||(l[11]=o=>e.form.with_attendance=!1),disabled:e.form.entries_count>0},null,8,["checked","disabled"]),i("span",D,u(t.$t("published_note")),1),G,e.form.entries_count>0?(r(),h("span",j," The form has responses, please backup before unpublished.")):c("",!0)]),_:1},8,["label"]),e.form.published?(r(),d(s,{key:3,label:t.$t("with_attendance"),name:"with_attendance"},{default:n(()=>[a(_,{checked:e.form.with_attendance,"onUpdate:checked":l[12]||(l[12]=o=>e.form.with_attendance=o),unCheckedValue:0,checkedValue:1},null,8,["checked"]),i("span",x,u(t.$t("with_attendance_note")),1)]),_:1},8,["label"])):c("",!0),a(s,{label:t.$t("banner_image"),name:"banner_image"},{default:n(()=>[e.form.media.length?(r(),h("div",I,[a(y,{href:t.route("manage.form.deleteMedia",e.form.media[0].id),class:"float-right text-red-500"},{default:n(()=>[Y]),_:1},8,["href"]),i("img",{src:e.form.media[0].preview_url,width:"100"},null,8,K)])):(r(),h("div",Q,[a(C,{"file-list":e.form.image,"onUpdate:fileList":l[13]||(l[13]=o=>e.form.image=o),multiple:!1,"max-count":1,"list-type":"picture-card",beforeUpload:()=>!1,"show-upload-list":!1,onChange:k.uploadChange},{default:n(()=>[f.imageUrl?(r(),h("img",{key:0,src:f.imageUrl,alt:"banner"},null,8,X)):(r(),h("div",Z,[f.loading?(r(),d(w,{key:0})):(r(),d(U,{key:1})),i("div",$,u(t.$t("upload")),1)]))]),_:1},8,["file-list","onChange"])]))]),_:1},8,["label"]),a(s,{"wrapper-col":{offset:12,span:10}},{default:n(()=>[a(q,{type:"primary","html-type":"submit"},{default:n(()=>[T("Submit")]),_:1})]),_:1})]),_:1},8,["model","rules","validate-messages","onFinish"])])])]),_:1},8,["title","breadcrumb"])}const ue=B(H,[["render",ee]]);export{ue as default};
