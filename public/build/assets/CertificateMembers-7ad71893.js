import{O as U}from"./OrganizationLayout-e59c3130.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{i as s,o as u,c as g,w as o,a as d,t,b as n,f as m,d as f,F as _,e as c}from"./app-78468d3b.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const D={components:{OrganizationLayout:U},props:["organization","certificate","members"],data(){return{breadcrumb:[{label:"證書列表",url:route("manage.certificates.index")},{label:"會員證書",url:null}],dateFormat:"YYYY-MM-DD",modal:{isOpen:!1,data:{},title:"Modal",mode:""},teacherStateLabels:{},columns:[{title:"Display Name",dataIndex:"display_name",i18n:"display_name"},{title:"Gender",dataIndex:"gender",i18n:"gender"},{title:"Issue Date",dataIndex:"issue_date",i18n:"issue_date"},{title:"Valid From",dataIndex:"valid_from",i18n:"valid_from"},{title:"Valid Until",dataIndex:"valid_until",i18n:"valid_until"},{title:"Operation",dataIndex:"operation",key:"operation",i18n:"operation"}],rules:{display_name:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(){this.modal.data={certificate_id:this.certificate.id},this.modal.member={},this.modal.mode="CREATE",this.modal.title="Add New Member",this.modal.isOpen=!0},editRecord(e){this.modal.data={...e.pivot},this.modal.member=e,this.modal.mode="EDIT",this.modal.title="Edit",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{console.log(this.modal.data),this.$inertia.post(route("manage.certificate.members.store",{certificate:this.modal.data.certificate_id}),this.modal.data,{onSuccess:e=>{console.log(e),this.modal.data={},this.modal.isOpen=!1},onError:e=>{console.log(e)}})}).catch(e=>{console.log(e)})},updateRecord(){console.log(this.modal.data.pivot),this.$refs.modalRef.validateFields().then(()=>{this.$inertia.put(route("manage.certificate.members.update",{certificate:this.modal.data.certificate_id,member:this.modal.data.member_id}),this.modal.data,{onSuccess:e=>{this.modal.data={},this.modal.isOpen=!1,console.log(e)},onError:e=>{console.log(e)}})}).catch(e=>{console.log("error",e)})},onChangeMember(e){const i=this.members.find(b=>b.id==e);this.modal.member=i,this.modal.data.display_name=i.given_name+" "+i.family_name}}},M={class:"font-semibold text-xl text-gray-800 leading-tight"},w={class:"flex-auto pb-3 text-right"};function N(e,i,b,S,l,v){const y=s("a-button"),C=s("a-table"),F=s("a-select"),r=s("a-form-item"),h=s("a-input"),k=s("a-date-picker"),I=s("a-textarea"),R=s("a-form"),z=s("a-modal"),O=s("OrganizationLayout");return u(),g(O,{title:"Dashboard",organization:b.organization},{header:o(()=>[d("h2",M,t(e.$t("certificates")),1)]),default:o(()=>[d("div",w,[n(y,{type:"primary",class:"!rounded",onClick:i[0]||(i[0]=a=>v.createRecord())},{default:o(()=>[m(t(e.$t("add_member")),1)]),_:1})]),n(C,{dataSource:b.certificate.members,columns:l.columns},{headerCell:o(({column:a})=>[m(t(a.i18n?e.$t(a.i18n):a.title),1)]),bodyCell:o(({column:a,text:T,record:p,index:V})=>[a.dataIndex=="operation"?(u(),g(y,{key:0,onClick:x=>v.editRecord(p)},{default:o(()=>[m(t(e.$t("edit")),1)]),_:2},1032,["onClick"])):a.dataIndex=="display_name"?(u(),f(_,{key:1},[m(t(p.pivot.display_name),1)],64)):a.dataIndex=="issue_date"?(u(),f(_,{key:2},[m(t(p.pivot.issue_date),1)],64)):a.dataIndex=="valid_from"?(u(),f(_,{key:3},[m(t(p.pivot.valid_from),1)],64)):a.dataIndex=="valid_until"?(u(),f(_,{key:4},[m(t(p.pivot.valid_until),1)],64)):(u(),f(_,{key:5},[m(t(p[a.dataIndex]),1)],64))]),expandedRowRender:o(({record:a})=>[d("p",null,t(e.$t("given_name"))+": "+t(a.given_name),1),d("p",null,t(e.$t("middle_name"))+": "+t(a.middle_name),1),d("p",null,t(e.$t("family_name"))+": "+t(a.family_name),1),d("p",null,t(e.$t("display_name"))+": "+t(a.display_name),1),d("p",null,t(e.$t("gender"))+": "+t(a.gender),1),d("p",null,t(e.$t("dob"))+": "+t(a.dob),1),d("p",null,t(e.$t("email"))+": "+t(a.email),1),d("p",null,t(e.$t("number"))+": "+t(a.pivot.number),1),d("p",null,t(e.$t("issue_date"))+": "+t(a.pivot.issue_date),1),d("p",null,t(e.$t("valid_until"))+": "+t(a.pivot.valid_until),1),d("p",null,t(e.$t("authorized_by"))+": "+t(a.pivot.authorized_by),1),d("p",null,t(e.$t("remark"))+": "+t(a.pivot.remark),1)]),expandColumnTitle:o(()=>[m(" Details ")]),_:1},8,["dataSource","columns"]),n(z,{visible:l.modal.isOpen,"onUpdate:visible":i[11]||(i[11]=a=>l.modal.isOpen=a),title:l.modal.title,width:"60%"},{footer:o(()=>[l.modal.mode=="EDIT"?(u(),g(y,{key:"Update",type:"primary",onClick:i[9]||(i[9]=a=>v.updateRecord())},{default:o(()=>[m(t(e.$t("update")),1)]),_:1})):c("",!0),l.modal.mode=="CREATE"?(u(),g(y,{key:"Store",type:"primary",onClick:i[10]||(i[10]=a=>v.storeRecord())},{default:o(()=>[m(t(e.$t("add")),1)]),_:1})):c("",!0)]),default:o(()=>[n(R,{ref:"modalRef",model:l.modal.data,name:"Teacher","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",rules:l.rules,"validate-messages":l.validateMessages},{default:o(()=>[n(r,{label:e.$t("member"),name:"member_id"},{default:o(()=>[n(F,{value:l.modal.data.member_id,"onUpdate:value":i[1]||(i[1]=a=>l.modal.data.member_id=a),options:b.members,fieldNames:{value:"id",label:"given_name"},onChange:v.onChangeMember},null,8,["value","options","onChange"])]),_:1},8,["label"]),n(r,{label:e.$t("full_name"),name:"full_name"},{default:o(()=>[m(t(l.modal.member.given_name)+" "+t(l.modal.member.middle_name)+" "+t(l.modal.member.family_name),1)]),_:1},8,["label"]),n(r,{label:e.$t("display_name"),name:"display_name"},{default:o(()=>[n(h,{value:l.modal.data.display_name,"onUpdate:value":i[2]||(i[2]=a=>l.modal.data.display_name=a)},null,8,["value"])]),_:1},8,["label"]),n(r,{label:e.$t("number"),name:"number"},{default:o(()=>[n(h,{value:l.modal.data.number,"onUpdate:value":i[3]||(i[3]=a=>l.modal.data.number=a)},null,8,["value"])]),_:1},8,["label"]),n(r,{label:e.$t("issue_date"),name:"issue_date"},{default:o(()=>[n(k,{value:l.modal.data.issue_date,"onUpdate:value":i[4]||(i[4]=a=>l.modal.data.issue_date=a),format:l.dateFormat,valueFormat:l.dateFormat},null,8,["value","format","valueFormat"])]),_:1},8,["label"]),n(r,{label:e.$t("valid_from"),name:"valid_from"},{default:o(()=>[n(k,{value:l.modal.data.valid_from,"onUpdate:value":i[5]||(i[5]=a=>l.modal.data.valid_from=a),format:l.dateFormat,valueFormat:l.dateFormat},null,8,["value","format","valueFormat"])]),_:1},8,["label"]),n(r,{label:e.$t("valid_until"),name:"valid_until"},{default:o(()=>[n(k,{value:l.modal.data.valid_until,"onUpdate:value":i[6]||(i[6]=a=>l.modal.data.valid_until=a),format:l.dateFormat,valueFormat:l.dateFormat},null,8,["value","format","valueFormat"])]),_:1},8,["label"]),n(r,{label:e.$t("authorized_by"),name:"authorized_by"},{default:o(()=>[n(h,{value:l.modal.data.authorized_by,"onUpdate:value":i[7]||(i[7]=a=>l.modal.data.authorized_by=a)},null,8,["value"])]),_:1},8,["label"]),n(r,{label:e.$t("remark"),name:"remark"},{default:o(()=>[n(I,{value:l.modal.data.remark,"onUpdate:value":i[8]||(i[8]=a=>l.modal.data.remark=a)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])]),_:1},8,["organization"])}const j=E(D,[["render",N]]);export{j as default};
