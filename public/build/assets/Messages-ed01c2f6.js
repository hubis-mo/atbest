import{O as U}from"./OrganizationLayout-e59c3130.js";import{q as T}from"./index-d20420be.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{U as z}from"./UploadOutlined-e5283a52.js";import{R as F}from"./RestFilled-9a3a2187.js";import{J as C,i as n,o as r,c as b,w as l,a as h,t as i,b as s,f as d,d as f,F as x,h as N,e as y}from"./app-78468d3b.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const B={components:{OrganizationLayout:U,UploadOutlined:z,RestFilled:F,quillEditor:T},props:["messageCategories","messages","members"],data(){return{modal:{isOpen:!1,data:{},title:"Modal",mode:""},pagination:{total:this.messages.total,current:this.messages.current_page,pageSize:this.messages.per_page},filter:{},columns:[{title:"Category",i18n:"type",dataIndex:"category_code",width:80},{title:"Title",i18n:"title",dataIndex:"title"},{title:"Sender",i18n:"sender",dataIndex:"sender",width:120},{title:"Receiver",i18n:"receiver",dataIndex:"receiver",width:120},{title:"Operation",i18n:"operation",dataIndex:"operation",key:"operation",width:200}],rules:{category_code:{required:!0},receiver:{required:!0},sender:{required:!0},title:{required:!0},content:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(e){this.modal.data={},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(e){this.modal.data={...e},this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("manage.messages.store"),this.modal.data,{preserveState:!1,onSuccess:e=>{this.modal.isOpen=!1,C.success("Create Successful.")},onError:e=>{console.log(e)}})}).catch(e=>{console.log(e)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.modal.data._method="PATCH",this.$inertia.post(route("manage.messages.update",this.modal.data.id),this.modal.data,{preserveState:!1,onSuccess:e=>{this.modal.isOpen=!1,C.success("Update Successful.")},onError:e=>{console.log(e)}})}).catch(e=>{console.log("error",e)})},deleteRecord(e){this.$inertia.delete(route("manage.messages.destroy",e),{preserveState:!1,onSuccess:t=>{C.success("Delete Successful."),console.log(t)},onError:t=>{alert(t.message)}})},onPaginationChange(e,t,u){this.$inertia.get(route("manage.messages.index"),{page:e.current,per_page:e.pageSize},{onSuccess:v=>{console.log(v)},onError:v=>{console.log(v)}})}}},L={class:"font-semibold text-xl text-gray-800 leading-tight"},M={class:"flex-auto pb-3 text-right"},V={class:"container mx-auto pt-5"},$={class:"bg-white relative shadow rounded-lg overflow-x-auto"},A={key:0,class:"space-x-2"},P={key:2};function H(e,t,u,v,o,m){const c=n("a-button"),S=n("a-popconfirm"),w=n("a-table"),R=n("a-select"),p=n("a-form-item"),k=n("a-input"),O=n("quill-editor"),E=n("a-form"),q=n("a-modal"),I=n("OrganizationLayout");return r(),b(I,{title:"Dashboard"},{header:l(()=>[h("h2",L,i(e.$t("messages")),1)]),default:l(()=>[h("div",M,[s(c,{type:"primary",class:"!rounded",onClick:t[0]||(t[0]=a=>m.createRecord())},{default:l(()=>[d(i(e.$t("create_message")),1)]),_:1})]),h("div",V,[h("div",$,[s(w,{dataSource:u.messages.data,columns:o.columns,pagination:o.pagination,onChange:m.onPaginationChange,ref:"dataTable"},{headerCell:l(({column:a})=>[d(i(a.i18n?e.$t(a.i18n):a.title),1)]),bodyCell:l(({column:a,text:J,record:_,index:j})=>[a.dataIndex=="operation"?(r(),f("div",A,[s(c,{onClick:g=>m.editRecord(_)},{default:l(()=>[d(i(e.$t("edit")),1)]),_:2},1032,["onClick"]),s(S,{title:e.$t("confirm_delete_record"),"ok-text":e.$t("yes"),"cancel-text":e.$t("no"),onConfirm:g=>m.deleteRecord(_.id)},{default:l(()=>[s(c,null,{default:l(()=>[d(i(e.$t("delete")),1)]),_:1})]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])])):a.dataIndex=="category_code"?(r(),f(x,{key:1},[d(i(u.messageCategories.find(g=>g.value==_.category_code).label),1)],64)):a.dataIndex=="receiver"?(r(),f("ol",P,[(r(!0),f(x,null,N(_.received_members,g=>(r(),f("li",null,i(g.given_name),1))),256))])):y("",!0)]),_:1},8,["dataSource","columns","pagination","onChange"])])]),s(q,{visible:o.modal.isOpen,"onUpdate:visible":t[8]||(t[8]=a=>o.modal.isOpen=a),title:o.modal.title,width:"60%"},{footer:l(()=>[o.modal.mode=="EDIT"?(r(),b(c,{key:"Update",type:"primary",onClick:t[6]||(t[6]=a=>m.updateRecord())},{default:l(()=>[d(i(e.$t("update")),1)]),_:1})):y("",!0),o.modal.mode=="CREATE"?(r(),b(c,{key:"Store",type:"primary",onClick:t[7]||(t[7]=a=>m.storeRecord())},{default:l(()=>[d(i(e.$t("add")),1)]),_:1})):y("",!0)]),default:l(()=>[s(E,{ref:"modalRef",model:o.modal.data,name:"Teacher","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",rules:o.rules,"validate-messages":o.validateMessages},{default:l(()=>[s(p,{label:e.$t("classification"),name:"category_code"},{default:l(()=>[s(R,{value:o.modal.data.category_code,"onUpdate:value":t[1]||(t[1]=a=>o.modal.data.category_code=a),options:u.messageCategories},null,8,["value","options"])]),_:1},8,["label"]),o.modal.data.category_code=="IND"?(r(),b(p,{key:0,label:"Receiver",name:"receiver"},{default:l(()=>[s(R,{mode:"multiple",value:o.modal.data.receiver,"onUpdate:value":t[2]||(t[2]=a=>o.modal.data.receiver=a),options:u.members,"field-names":{label:"display_name",value:"id"}},null,8,["value","options"])]),_:1})):y("",!0),s(p,{label:e.$t("sender"),name:"sender"},{default:l(()=>[s(k,{value:o.modal.data.sender,"onUpdate:value":t[3]||(t[3]=a=>o.modal.data.sender=a)},null,8,["value"])]),_:1},8,["label"]),s(p,{label:e.$t("title"),name:"title"},{default:l(()=>[s(k,{value:o.modal.data.title,"onUpdate:value":t[4]||(t[4]=a=>o.modal.data.title=a)},null,8,["value"])]),_:1},8,["label"]),s(p,{label:e.$t("content"),name:"content"},{default:l(()=>[s(O,{value:o.modal.data.content,"onUpdate:value":t[5]||(t[5]=a=>o.modal.data.content=a),style:{"min-height":"200px"}},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])]),_:1})}const oe=D(B,[["render",H]]);export{oe as default};
