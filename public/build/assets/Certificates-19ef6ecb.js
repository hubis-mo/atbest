import{O as S}from"./OrganizationLayout-e59c3130.js";import{_ as U}from"./CropperModal-92f58e74.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";import{a3 as E,a2 as P,a9 as T,i as d,o as m,c as b,w as i,a as s,t as r,b as l,f as n,d as _,F as g,e as h}from"./app-78468d3b.js";import{U as A}from"./UploadOutlined-e5283a52.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const L={components:{OrganizationLayout:S,UploadOutlined:A,LoadingOutlined:E,PlusOutlined:P,InfoCircleFilled:T,CropperModal:U},props:["certificates","certificate_categories"],data(){return{breadcrumb:[{label:"證書列表",url:null}],loading:!1,uploadPreview:null,uploadData:null,cropper:{showModal:!1,preview:null,data:null},modal:{isOpen:!1,data:{},title:"Modal",mode:""},teacherStateLabels:{},columns:[{title:"Cert Title",dataIndex:"cert_title",i18n:"certificate_title"},{title:"Cert Body",dataIndex:"cert_body",i18n:"cert_body"},{title:"Number Format",dataIndex:"number_format",i18n:"number_format"},{title:"Cert. Logo",dataIndex:"cert_logo",i18n:"cert_logo"},{title:"Cert. template",dataIndex:"cert_template",i18n:"cert_template"},{title:"操作",dataIndex:"operation",key:"operation",i18n:"operation"}],rules:{category_code:{required:!0},cert_title:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{setCroppedImageData(e){this.uploadPreview=e.imageUrl,this.uploadData=e,console.log(e.file.name)},createRecord(){this.modal.data={},this.modal.mode="CREATE",this.modal.title="create",this.modal.isOpen=!0},editRecord(e){this.modal.data={...e},this.modal.mode="EDIT",this.modal.title="edit",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("manage.certificates.store"),this.modal.data,{onSuccess:e=>{this.modal.data={},this.modal.isOpen=!1},onError:e=>{console.log(e)}})}).catch(e=>{console.log(e)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.modal.data.cert_logo_upload={filename:"abc",file:this.uploadData.blob},this.modal.data._method="PATCH",console.log(this.modal.data),this.$inertia.patch(route("manage.certificates.update",this.modal.data.id),this.modal.data,{onSuccess:e=>{},onError:e=>{console.log(e)}})}).catch(e=>{console.log("error",e)})},modalClose(){},onSubmit(){this.modal.data.cert_logo_upload=this.uploadData.blob,this.modal.data.orignial_file_name=this.uploadData.file.name,this.modal.data._method="PATCH",this.$inertia.post(route("manage.certificates.update",this.modal.data.id),this.modal.data,{onSuccess:e=>{},onError:e=>{console.log(e)}})}}},z={class:"font-semibold text-xl text-gray-800 leading-tight"},B={class:"flex-auto pb-3 text-right"},F={class:"container mx-auto pt-5"},H={class:"bg-white relative shadow rounded-lg overflow-x-auto"},N={class:"flex flex-wrap mt-4 mb-6"},q={class:"w-full px-3"},V={key:0},j=["src"],G={key:1},J=s("svg",{focusable:"false",class:"","data-icon":"delete",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",viewBox:"64 64 896 896"},[s("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"})],-1),K=["src"];function Q(e,o,y,W,t,c){const p=d("a-button"),C=d("inertia-link"),w=d("a-table"),k=d("a-select"),u=d("a-form-item"),f=d("a-input"),I=d("CropperModal"),R=d("a-form"),M=d("a-modal"),O=d("OrganizationLayout");return m(),b(O,{title:"證書",breadcrumb:t.breadcrumb},{header:i(()=>[s("h2",z,r(e.$t("certificates")),1)]),default:i(()=>[s("div",B,[l(p,{type:"primary",class:"!rounded",onClick:o[0]||(o[0]=a=>c.createRecord())},{default:i(()=>[n(r(e.$t("create_certificate")),1)]),_:1})]),s("div",F,[s("div",H,[l(w,{dataSource:y.certificates,columns:t.columns},{headerCell:i(({column:a})=>[n(r(a.i18n?e.$t(a.i18n):a.title),1)]),bodyCell:i(({column:a,text:D,record:v,index:X})=>[a.dataIndex=="operation"?(m(),_(g,{key:0},[l(p,{onClick:Y=>c.editRecord(v)},{default:i(()=>[n(r(e.$t("edit")),1)]),_:2},1032,["onClick"]),l(C,{href:e.route("manage.certificate.members.index",v.id),class:"ant-btn"},{default:i(()=>[n(r(e.$t("members")),1)]),_:2},1032,["href"])],64)):a.dataIndex=="state"?(m(),_(g,{key:1},[n(r(t.teacherStateLabels[D]),1)],64)):(m(),_(g,{key:2},[n(r(v[a.dataIndex]),1)],64))]),_:1},8,["dataSource","columns"])])]),l(M,{visible:t.modal.isOpen,"onUpdate:visible":o[12]||(o[12]=a=>t.modal.isOpen=a),title:e.$t(t.modal.title),width:"60%",afterClose:c.modalClose},{footer:i(()=>[l(p,{onClick:c.onSubmit,type:"primary"},{default:i(()=>[n(r(e.$t("submit")),1)]),_:1},8,["onClick"]),t.modal.mode=="EDIT"?(m(),b(p,{key:"Update",type:"primary",onClick:o[10]||(o[10]=a=>c.updateRecord())},{default:i(()=>[n(r(e.$t("update")),1)]),_:1})):h("",!0),t.modal.mode=="CREATE"?(m(),b(p,{key:"Store",type:"primary",onClick:o[11]||(o[11]=a=>c.storeRecord())},{default:i(()=>[n(r(e.$t("Add")),1)]),_:1})):h("",!0)]),default:i(()=>[l(R,{ref:"modalRef",model:t.modal.data,name:"Certificate","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",rules:t.rules,"validate-messages":t.validateMessages,enctype:"multipart/form-data"},{default:i(()=>[l(u,{label:e.$t("type_of_certificate"),name:"category_code"},{default:i(()=>[l(k,{value:t.modal.data.category_code,"onUpdate:value":o[1]||(o[1]=a=>t.modal.data.category_code=a),options:y.certificate_categories},null,8,["value","options"])]),_:1},8,["label"]),l(u,{label:e.$t("certificate_title"),name:"cert_title"},{default:i(()=>[l(f,{value:t.modal.data.cert_title,"onUpdate:value":o[2]||(o[2]=a=>t.modal.data.cert_title=a)},null,8,["value"])]),_:1},8,["label"]),l(u,{label:e.$t("certificate_body"),name:"cert_body"},{default:i(()=>[l(f,{value:t.modal.data.cert_body,"onUpdate:value":o[3]||(o[3]=a=>t.modal.data.cert_body=a)},null,8,["value"])]),_:1},8,["label"]),l(u,{label:e.$t("cert_logo"),name:"cert_logo"},{default:i(()=>[l(p,{onClick:o[4]||(o[4]=a=>t.cropper.showModal=!0)},{default:i(()=>[n(r(e.$t("upload_profile_image")),1)]),_:1}),t.cropper.showModal?(m(),b(I,{key:0,minAspectRatioProp:{width:8,height:8},maxAspectRatioProp:{width:8,height:8},onCroppedImageData:c.setCroppedImageData,onShowModal:o[5]||(o[5]=a=>t.cropper.showModal=!1)},null,8,["onCroppedImageData"])):h("",!0),s("div",N,[s("div",q,[t.uploadPreview?(m(),_("div",V,[s("img",{src:t.uploadPreview,class:"md:w-1/2"},null,8,j)])):t.modal.data.media?(m(),_("div",G,[l(C,{href:e.route("manage.certificate.deleteMedia",t.modal.data.media[0].id),class:"float-right text-red-500"},{default:i(()=>[J]),_:1},8,["href"]),s("img",{src:t.modal.data.media[0].original_url,class:"md:w-1/2"},null,8,K)])):h("",!0)])])]),_:1},8,["label"]),l(u,{label:e.$t("certificate_template"),name:"cert_template"},{default:i(()=>[l(f,{value:t.modal.data.cert_template,"onUpdate:value":o[6]||(o[6]=a=>t.modal.data.cert_template=a)},null,8,["value"])]),_:1},8,["label"]),l(u,{label:e.$t("number_format"),name:"number_format"},{default:i(()=>[l(f,{value:t.modal.data.number_format,"onUpdate:value":o[7]||(o[7]=a=>t.modal.data.number_format=a)},null,8,["value"])]),_:1},8,["label"]),l(u,{label:e.$t("rank_caption"),name:"rank_caption"},{default:i(()=>[l(f,{value:t.modal.data.rank_catption,"onUpdate:value":o[8]||(o[8]=a=>t.modal.data.rank_catption=a)},null,8,["value"])]),_:1},8,["label"]),l(u,{label:e.$t("description"),name:"description"},{default:i(()=>[l(f,{value:t.modal.data.description,"onUpdate:value":o[9]||(o[9]=a=>t.modal.data.description=a)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title","afterClose"])]),_:1},8,["breadcrumb"])}const de=x(L,[["render",Q]]);export{de as default};
