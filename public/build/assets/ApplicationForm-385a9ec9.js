import{_ as A}from"./WebLayout-0d81791d.js";import{I as C,J as B,M as I,i as m,o as n,c as _,w as i,a as s,d,e as v,b as o,f as c,t as p,h as g,F as f,k,K as O}from"./app-78468d3b.js";import{_ as H}from"./CropperModal-92f58e74.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-51fcef62.js";import"./UploadOutlined-e5283a52.js";const T={components:{WebLayout:A,dayjs:C,message:B,Modal:I,CropperModal:H},props:["organizations","belt_ranks","member","competition"],data(){return{showCropModal:!1,avatarPreview:null,modal:{isOpen:!1,title:"Application Failed",content:"Error message"},mode:null,dateFormat:"YYYY-MM-DD",dateList:["2023-01-02"],application:{},rules:{organization_id:{required:!0},name_fn:{required:!0},id_num:{required:!0},dob:{required:!0},gender:{required:!0},email:{required:!0,type:"email"},mobile:{required:!0},category:{required:!0},weight:{required:!0},role:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},layout:{labelCol:{span:8},wrapperCol:{span:16}},virticalStyle:{display:"flex",minHeight:"30px",lineHeight:"30px",marginLeft:"8px"}}},mounted(){this.application.competition_id=this.competition.id,this.member&&(this.application.member_id=this.member.id,this.application.given_name=this.member.given_name,this.application.family_name=this.member.family_name,this.application.middle_name=this.member.middle_name,this.application.display_name=this.member.display_name,this.application.gender=this.member.gender,this.application.dob=this.member.dob,this.application.email=this.member.email,this.application.mobile=this.member.mobile),this.application.dob==null&&(console.log("preset dob"),this.application.dob=C(new Date).subtract(10,"year").format(this.dateFormat))},created(){},methods:{setCroppedImageData(a){this.avatarPreview=a.imageUrl,this.avatarData=a},onGenderChange(a){this.application.category&&this.weightSelection(a.target.value,this.application.category),this.application.role=null,this.application.category=null,this.application.weight=null},onCategoryChange(a){this.application.weight=null,this.application.gender&&this.weightSelection(this.application.gender,a.target.value)},weightSelection(a,l){a=="M"?this.competition.weights=this.competition.categories_weights.find(r=>r.code==l).male:this.competition.weights=this.competition.categories_weights.find(r=>r.code==l).female},onFinish(){this.avatarData&&(this.application.avatar=this.avatarData.blob),this.$inertia.post(route("competitions.store"),this.application,{onSuccess:a=>{console.log(a)},onError:a=>{console.log(a)}})},disabledDate(a){return a>C(new Date).subtract(3,"year")}}},V=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," 表格例表 ",-1),Y={class:"py-0"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},W={class:"p-5 bg-white overflow-hidden shadow-xl sm:rounded-lg"},j={key:0},G=["src"],R={id:"pure-html"},J=["innerHTML"],K=["href"],Q={class:"flex flex-wrap mt-4 mb-6"},X={class:"w-full md:w-1/2 px-3"},Z={key:0},$=["src"],ee={key:1},te=["src"],le={class:"flex flex-row item-center justify-center"},ie=s("p",null,"Duplicate entry,",-1),ae=s("p",null,"If you are Athlete, you may apply at most 2 categories in the same competition.",-1),oe=s("p",null,"Or you may apply one role only.",-1);function ne(a,l,r,re,e,h){const M=m("a-typography-title"),D=m("a-select"),u=m("a-form-item"),y=m("a-input"),U=m("a-date-picker"),b=m("a-radio"),w=m("a-radio-group"),z=m("a-checkbox"),q=m("a-checkbox-group"),F=m("a-button"),x=m("CropperModal"),S=m("a-form"),P=m("a-modal"),L=m("WebLayout");return n(),_(L,{title:"Dashboard"},{header:i(()=>[V]),default:i(()=>[s("div",Y,[s("div",E,[s("div",W,[r.competition.media.find(t=>t.collection_name=="competitionBanner")?(n(),d("div",j,[s("img",{src:r.competition.media.find(t=>t.collection_name=="competitionBanner").original_url,style:{width:"100%"}},null,8,G)])):v("",!0),o(M,{level:3,class:"text-center"},{default:i(()=>[c(p(r.competition.title_zh),1)]),_:1}),s("div",R,[s("div",{innerHTML:r.competition.description},null,8,J)]),s("ol",null,[(n(!0),d(f,null,g(r.competition.media.filter(t=>t.collection_name=="competitionAttachment"),t=>(n(),d("li",null,[s("a",{href:t.original_url,target:"_blank"},p(t.file_name),9,K)]))),256))]),o(M,{level:4},{default:i(()=>[c(p(a.$t("application_fee"))+"： MOP$"+p(r.competition.fee),1)]),_:1}),o(S,O({model:e.application},e.layout,{name:"nest-messages","validate-messages":e.validateMessages,layout:"vertical",rules:e.rules,onFinish:h.onFinish}),{default:i(()=>[o(u,{label:a.$t("organization"),name:"organization_id"},{default:i(()=>[o(D,{value:e.application.organization_id,"onUpdate:value":l[0]||(l[0]=t=>e.application.organization_id=t),options:r.organizations,"field-names":{value:"id",label:"title"}},null,8,["value","options"])]),_:1},8,["label"]),o(u,{label:a.$t("name_zh"),name:"name_zh"},{default:i(()=>[o(y,{value:e.application.name_zh,"onUpdate:value":l[1]||(l[1]=t=>e.application.name_zh=t)},null,8,["value"])]),_:1},8,["label"]),o(u,{label:a.$t("name_fn"),name:"name_fn"},{default:i(()=>[o(y,{value:e.application.name_fn,"onUpdate:value":l[2]||(l[2]=t=>e.application.name_fn=t)},null,8,["value"])]),_:1},8,["label"]),o(u,{label:a.$t("id_num"),name:"id_num"},{default:i(()=>[o(y,{value:e.application.id_num,"onUpdate:value":l[3]||(l[3]=t=>e.application.id_num=t)},null,8,["value"])]),_:1},8,["label"]),o(u,{label:a.$t("belt_rank"),name:"belt_rank",rules:[{required:["athlete","referee","coach"].includes(e.application.role)}]},{default:i(()=>[o(D,{value:e.application.belt_rank,"onUpdate:value":l[4]||(l[4]=t=>e.application.belt_rank=t),options:r.belt_ranks,"field-names":{value:"rankCode",label:"name_zh"}},null,8,["value","options"])]),_:1},8,["label","rules"]),o(u,{label:a.$t("dob"),name:"dob"},{default:i(()=>[o(U,{value:e.application.dob,"onUpdate:value":l[5]||(l[5]=t=>e.application.dob=t),format:e.dateFormat,valueFormat:e.dateFormat,disabledDate:h.disabledDate},null,8,["value","format","valueFormat","disabledDate"])]),_:1},8,["label"]),o(u,{label:a.$t("gender"),name:"gender"},{default:i(()=>[o(w,{value:e.application.gender,"onUpdate:value":l[6]||(l[6]=t=>e.application.gender=t),onChange:h.onGenderChange},{default:i(()=>[o(b,{value:"M"},{default:i(()=>[c(p(a.$t("male")),1)]),_:1}),o(b,{value:"F"},{default:i(()=>[c(p(a.$t("female")),1)]),_:1})]),_:1},8,["value","onChange"])]),_:1},8,["label"]),o(u,{label:a.$t("email"),name:"email"},{default:i(()=>[o(y,{value:e.application.email,"onUpdate:value":l[7]||(l[7]=t=>e.application.email=t)},null,8,["value"])]),_:1},8,["label"]),o(u,{label:a.$t("mobile_number"),name:"mobile"},{default:i(()=>[o(y,{value:e.application.mobile,"onUpdate:value":l[8]||(l[8]=t=>e.application.mobile=t)},null,8,["value"])]),_:1},8,["label"]),e.application.gender?(n(),_(u,{key:0,label:a.$t("role"),name:"role"},{default:i(()=>[o(w,{value:e.application.role,"onUpdate:value":l[9]||(l[9]=t=>e.application.role=t)},{default:i(()=>[(n(!0),d(f,null,g(r.competition.roles,t=>(n(),_(b,{value:t.value,style:k(e.virticalStyle)},{default:i(()=>[c(p(t.label),1)]),_:2},1032,["value","style"]))),256))]),_:1},8,["value"])]),_:1},8,["label"])):v("",!0),e.application.role=="athlete"&&e.application.gender?(n(),d(f,{key:1},[o(u,{label:a.$t("category"),name:"category"},{default:i(()=>[o(w,{value:e.application.category,"onUpdate:value":l[10]||(l[10]=t=>e.application.category=t)},{default:i(()=>[(n(!0),d(f,null,g(r.competition.categories_weights,t=>(n(),_(b,{value:t.code,style:k(e.virticalStyle),onChange:h.onCategoryChange},{default:i(()=>[c(p(t.name)+" - ["+p(t.description)+"] ",1)]),_:2},1032,["value","style","onChange"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),o(u,{label:a.$t("weight"),name:"weight"},{default:i(()=>[o(w,{value:e.application.weight,"onUpdate:value":l[11]||(l[11]=t=>e.application.weight=t)},{default:i(()=>[(n(!0),d(f,null,g(r.competition.weights,t=>(n(),_(b,{style:k(e.virticalStyle),value:t.code},{default:i(()=>[c(p(t.name),1)]),_:2},1032,["style","value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"])],64)):v("",!0),e.application.role=="referee"?(n(),d(f,{key:2},[e.application.gender?(n(),_(u,{key:0,label:a.$t("referee_options"),name:"referee_options"},{default:i(()=>[o(w,{value:e.application.referee_options,"onUpdate:value":l[12]||(l[12]=t=>e.application.referee_options=t)},{default:i(()=>[(n(!0),d(f,null,g(r.competition.referee_options,t=>(n(),_(b,{value:t.value,style:k(e.virticalStyle)},{default:i(()=>[c(p(t.label),1)]),_:2},1032,["value","style"]))),256))]),_:1},8,["value"])]),_:1},8,["label"])):v("",!0)],64)):v("",!0),e.application.role=="staff"?(n(),d(f,{key:3},[e.application.gender?(n(),_(u,{key:0,label:a.$t("staff_options"),name:"staff_options"},{default:i(()=>[o(q,{value:e.application.staff_options,"onUpdate:value":l[13]||(l[13]=t=>e.application.staff_options=t)},{default:i(()=>[(n(!0),d(f,null,g(r.competition.staff_options,t=>(n(),_(z,{value:t.value,style:k(e.virticalStyle)},{default:i(()=>[c(p(t.label),1)]),_:2},1032,["value","style"]))),256))]),_:1},8,["value"])]),_:1},8,["label"])):v("",!0)],64)):v("",!0),o(F,{onClick:l[14]||(l[14]=t=>e.showCropModal=!0)},{default:i(()=>[c(p(a.$t("upload_profile_image")),1)]),_:1}),e.showCropModal?(n(),_(x,{key:4,minAspectRatioProp:{width:8,height:8},maxAspectRatioProp:{width:8,height:8},onCroppedImageData:h.setCroppedImageData,onShowModal:l[15]||(l[15]=t=>e.showCropModal=!1)},null,8,["onCroppedImageData"])):v("",!0),s("div",Q,[s("div",X,[e.avatarPreview!==null?(n(),d("div",Z,[s("img",{src:e.avatarPreview},null,8,$)])):(n(),d("div",ee,[s("img",{src:r.competition.avatar_url},null,8,te)]))])]),s("div",le,[o(F,{type:"primary","html-type":"submit"},{default:i(()=>[c(p(a.$t("submit")),1)]),_:1})])]),_:1},16,["model","validate-messages","rules","onFinish"])])])]),o(P,{visible:e.modal.isOpen,"onUpdate:visible":l[16]||(l[16]=t=>e.modal.isOpen=t),title:e.modal.title,cancelButtonProps:{style:"display:none"},okText:"$t{'understand'}"},{default:i(()=>[ie,ae,oe,s("p",null,p(e.modal.content),1)]),_:1},8,["visible","title"])]),_:1})}const _e=N(T,[["render",ne]]);export{_e as default};
