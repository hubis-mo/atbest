import{O as x}from"./OrganizationLayout-e59c3130.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import{a6 as q,a7 as F,a8 as M,i as m,o,c as k,w as l,a as y,t as i,b as s,f as r,d as p,F as b,e as f,h as I}from"./app-78468d3b.js";import"./DropdownLink-c7da729b.js";import"./TeamOutlined-f908f4bf.js";import"./PieChartOutlined-7a16d42c.js";import"./FormOutlined-55ddf1ad.js";const z={components:{OrganizationLayout:x,DeleteOutlined:q,CheckOutlined:F,EditOutlined:M},props:["event","attendees","members","attendance_status"],data(){return{editableData:{},activeKey:["1"],targetKeys:[],selectedKeys:[],inputName:null,inputNameList:[],batchInputNames:null,batchInputNameList:[],modal:{isOpen:!1,title:"Modal"},columns:[{title:"Display Name",i18n:"display_name",dataIndex:"display_name"},{title:"Attendance Status",i18n:"status",dataIndex:"status"},{title:"Member",i18n:"member",dataIndex:"member"},{title:"Operation",i18n:"operation",dataIndex:"operation",key:"operation"}],rules:{name_zh:{required:!0},mobile:{required:!0},state:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){Object.values(this.attendees).forEach(e=>{e.attendee_type=="App\\Models\\Member"&&this.targetKeys.push(e.attendee_id.toString())})},methods:{addAttendees(){this.modal.title=this.$t("add_attendees"),this.modal.isOpen=!0},onClickShowSelected(){var e={};this.members.forEach(t=>{this.targetKeys.includes(t.id.toString())&&(e[t.id]={display_name:t.display_name})}),this.$inertia.post(route("manage.event.attendees.store",this.event.id),{model:"member",data:e},{onSuccess:t=>{this.modal.data={},this.modal.isOpen=!1},onError:t=>{console.log(t)}})},addInputName(){this.inputNameList.push({display_name:this.inputName}),this.inputName=null},storeInputNameList(){this.$inertia.post(route("manage.event.attendees.store",this.event.id),{model:"other",data:this.inputNameList},{onSuccess:e=>{this.modal.data={},this.modal.isOpen=!1,this.inputNameList=[]},onError:e=>{console.log(e)}})},addBatchInputNames(){var e=this.batchInputNames.split(/[',|;|\r|\n']/).filter(t=>t!=="");e.forEach(t=>{this.inputNameList.push({display_name:t})}),this.batchInputNames=null},deleteFromInputNameList(e){this.inputNameList.splice(e,1)},deleteAttendee(e){this.$inertia.delete(route("manage.event.attendees.destroy",{event:this.event.id,attendee:e.id}),{onSuccess:t=>{console.log("attendee removed!")},onError:t=>{console.log(t)}})},editAttendee(e){this.editableData[e.id]=e},saveAttendee(e){this.$inertia.patch(route("manage.event.attendees.update",{event:this.event.id,attendee:e.id}),e,{onSuccess:t=>{console.log("attendee name updated!")},onError:t=>{console.log(t)}}),delete this.editableData[e.id]},updateAttendeeAttendance(e){console.log(e),this.saveAttendee(e)},handleChange(e,t,v){console.log(e,t,v)}}},V={class:"font-semibold text-xl text-gray-800 leading-tight"},R={class:"flex-auto pb-3 text-right"},T={key:2,class:"editable-cell"},P={key:0,class:"editable-cell-input-wrapper"},j={key:1,class:"editable-cell-text-wrapper"},G={class:"list-disc ml-5"},H=["onClick"],J={class:"list-disc ml-5"};function Q(e,t,v,W,n,u){const c=m("a-button"),C=m("a-input"),L=m("check-outlined"),A=m("edit-outlined"),O=m("a-select"),K=m("a-table"),S=m("a-transfer"),g=m("a-collapse-panel"),N=m("DeleteOutlined"),E=m("a-form-item"),w=m("a-textarea"),D=m("a-collapse"),$=m("a-modal"),U=m("OrganizationLayout");return o(),k(U,{title:"Dashboard"},{header:l(()=>[y("h2",V,i(e.$t("attendees")),1)]),default:l(()=>[y("div",R,[s(c,{onClick:u.addAttendees},{default:l(()=>[r(i(e.$t("add_attendees")),1)]),_:1},8,["onClick"])]),s(K,{dataSource:v.attendees,columns:n.columns},{headerCell:l(({column:a})=>[r(i(a.i18n?e.$t(a.i18n):a.title),1)]),bodyCell:l(({column:a,text:_,record:d,index:X})=>[a.dataIndex=="operation"?(o(),k(c,{key:0,onClick:h=>u.deleteAttendee(d)},{default:l(()=>[r(i(e.$t("delete")),1)]),_:2},1032,["onClick"])):a.dataIndex=="member"?(o(),p(b,{key:1},[d.member?(o(),p(b,{key:0},[r(i(e.$t("member"))+":"+i(d.member.member_number),1)],64)):d.participant?(o(),p(b,{key:1},[r(i(d.participant),1)],64)):f("",!0)],64)):a.dataIndex=="display_name"?(o(),p("div",T,[n.editableData[d.id]?(o(),p("div",P,[s(C,{value:n.editableData[d.id].display_name,"onUpdate:value":h=>n.editableData[d.id].display_name=h,onPressEnter:h=>e.save(d.key)},null,8,["value","onUpdate:value","onPressEnter"]),s(L,{class:"editable-cell-icon-check",onClick:h=>u.saveAttendee(d)},null,8,["onClick"])])):(o(),p("div",j,[r(i(_||" ")+" ",1),s(A,{class:"editable-cell-icon",onClick:h=>u.editAttendee(d)},null,8,["onClick"])]))])):a.dataIndex=="status"?(o(),k(O,{key:3,value:d.status,"onUpdate:value":h=>d.status=h,options:v.attendance_status,style:{width:"100px"},onChange:h=>u.updateAttendeeAttendance(d)},null,8,["value","onUpdate:value","options","onChange"])):(o(),p(b,{key:4},[r(i(d[a.dataIndex]),1)],64))]),_:1},8,["dataSource","columns"]),s($,{visible:n.modal.isOpen,"onUpdate:visible":t[8]||(t[8]=a=>n.modal.isOpen=a),title:n.modal.title,width:"60%"},{footer:l(()=>[n.modal.mode=="EDIT"?(o(),k(c,{key:"Update",type:"primary",onClick:t[6]||(t[6]=a=>e.updateRecord())},{default:l(()=>[r(i(e.$t("update")),1)]),_:1})):f("",!0),n.modal.mode=="CREATE"?(o(),k(c,{key:"Store",type:"primary",onClick:t[7]||(t[7]=a=>e.storeRecord())},{default:l(()=>[r(i(e.$t("add")),1)]),_:1})):f("",!0)]),default:l(()=>[s(D,{activeKey:n.activeKey,"onUpdate:activeKey":t[5]||(t[5]=a=>n.activeKey=a),accordion:""},{default:l(()=>[s(g,{key:"1",header:e.$t("select_members_to_attendees_list")},{default:l(()=>[s(S,{"target-keys":n.targetKeys,"onUpdate:targetKeys":t[0]||(t[0]=a=>n.targetKeys=a),"selected-keys":n.selectedKeys,"onUpdate:selectedKeys":t[1]||(t[1]=a=>n.selectedKeys=a),"data-source":v.members.map(a=>({key:a.id.toString(),title:a.display_name})),"show-search":"","list-style":{width:"250px",height:"300px"},operations:["",""],"select-all-labels":[({selectedCount:a,totalCount:_})=>`${a}/${_}`,({selectedCount:a,totalCount:_})=>`${a}/${_}`,,],titles:[e.$t("members"),e.$t("attendees")],render:a=>`${a.key}-${a.title}`,onChange:u.handleChange},null,8,["target-keys","selected-keys","data-source","select-all-labels","titles","render","onChange"]),s(c,{onClick:u.onClickShowSelected},{default:l(()=>[r(i(e.$t("add_members_as_attendees")),1)]),_:1},8,["onClick"])]),_:1},8,["header"]),s(g,{key:"2",header:e.$t("input_non_member_to_attendees_list")},{default:l(()=>[y("ol",G,[(o(!0),p(b,null,I(n.inputNameList,(a,_)=>(o(),p("li",null,[r(i(a.display_name)+" ",1),y("span",{class:"float-right text-red-300",onClick:d=>u.deleteFromInputNameList(_)},[s(N)],8,H)]))),256))]),s(E,{label:e.$t("attendee_name"),name:"attendeeName"},{default:l(()=>[s(C,{value:n.inputName,"onUpdate:value":t[2]||(t[2]=a=>n.inputName=a)},null,8,["value"])]),_:1},8,["label"]),s(c,{onClick:u.addInputName},{default:l(()=>[r(i(e.$t("add")),1)]),_:1},8,["onClick"]),s(c,{onClick:u.storeInputNameList,class:"float-right"},{default:l(()=>[r(i(e.$t("save")),1)]),_:1},8,["onClick"])]),_:1},8,["header"]),s(g,{key:"3",header:e.$t("batch_input_non_member_to_attendees_list")},{default:l(()=>[y("ol",J,[(o(!0),p(b,null,I(n.inputNameList,a=>(o(),p("li",null,[r(i(a.display_name)+" ",1),y("span",{class:"float-right text-red-300",onClick:t[3]||(t[3]=_=>u.deleteFromInputNameList(e.id))},[s(N)])]))),256))]),y("label",null,i(e.$t("attendee_name")),1),s(w,{value:n.batchInputNames,"onUpdate:value":t[4]||(t[4]=a=>n.batchInputNames=a),rows:10},null,8,["value"]),s(c,{onClick:u.addBatchInputNames},{default:l(()=>[r(i(e.$t("add")),1)]),_:1},8,["onClick"]),s(c,{onClick:u.storeInputNameList,class:"float-right"},{default:l(()=>[r(i(e.$t("save")),1)]),_:1},8,["onClick"])]),_:1},8,["header"])]),_:1},8,["activeKey"])]),_:1},8,["visible","title"])]),_:1})}const le=B(z,[["render",Q],["__scopeId","data-v-833a1b5d"]]);export{le as default};
